<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Renter Dashboard | RentoVerse</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="color-scheme" content="light dark" />
    <style>
        /* Smooth fade */
        @keyframes fade-in-up { 0% { transform: translateY(8px); opacity: .0; } 100% { transform: translateY(0); opacity: 1; } }
        .animate-fade-in-up { animation: fade-in-up .25s ease-out both; }

        /* Generic card look for injected items */
        #allRooms > *, #pendingRequests > *, #confirmationList > *, #visitList > * {
            background: #fff; border: 1px solid rgb(229 231 235);
            border-radius: 16px; overflow: hidden;
            box-shadow: 0 6px 18px -10px rgba(0,0,0,.25);
            transition: transform .15s ease, box-shadow .15s ease;
        }
        #allRooms > *:hover, #pendingRequests > *:hover, #confirmationList > *:hover, #visitList > *:hover {
            transform: translateY(-2px); box-shadow: 0 10px 24px -12px rgba(0,0,0,.35);
        }

        /* Skeleton shimmer (optional placeholders) */
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        .skeleton {
            background: linear-gradient(90deg,#f8fafc 25%,#e5e7eb 37%,#f8fafc 63%);
            background-size: 400% 100%; animation: shimmer 1.1s infinite linear; border-radius: 12px;
        }

        /* Toast base (for #rdToast & #requestStatus if used) */
        #rdToast { background:#111827; border-radius:12px; }
    </style>

    <style>
        /* Search fields soft palette + focus */
        #searchLocation, #searchMaxRent, #searchType{
            background:#F0F9FF;           /* sky-50 */
            border-color:#93C5FD;          /* blue-300 */
            color:#0f172a;                 /* slate-900 */
        }
        #searchLocation::placeholder, #searchMaxRent::placeholder{ color:#94a3b8; } /* slate-400 */

        #searchLocation:focus, #searchMaxRent:focus, #searchType:focus{
            outline:none;
            border-color:#6366f1;          /* indigo-500 */
            box-shadow:0 0 0 4px rgba(99,102,241,.18);
        }

        /* Pending requests cards: padding + no clipping (extra safety) */
        #pendingRequests > *{ padding:14px; overflow:visible; }
    </style>

</head>
<body class="bg-gradient-to-b from-emerald-50 via-white to-white text-gray-800">

<!-- Sticky header (deep gradient + two-line profile) -->
<header class="sticky top-0 z-10 shadow-sm bg-gradient-to-r from-emerald-700 via-teal-700 to-sky-700 text-white">
    <div class="max-w-6xl mx-auto px-6 h-14 grid grid-cols-3 items-center">
        <!-- Left -->
        <a href="index.html"
           class="justify-self-start text-white/90 hover:text-white underline-offset-4 hover:underline">
            Home
        </a>

        <!-- Center -->
        <h1 class="justify-self-center text-xl md:text-2xl font-extrabold">Renter Dashboard</h1>

        <!-- Right: profile (Name on top, Email below) + Logout -->
        <div class="justify-self-end flex items-center gap-3">
            <div class="flex items-center gap-2 rounded-xl bg-white/10 px-3 py-1.5">
        <span class="inline-grid place-items-center w-7 h-7 rounded-full bg-white/20">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 12a5 5 0 1 0-5-5 5.006 5.006 0 0 0 5 5Zm0 2c-5.33 0-8 2.667-8 4v1h16v-1c0-1.333-2.67-4-8-4Z"/>
          </svg>
        </span>
                <div class="leading-tight">
                    <div id="renterName" class="font-semibold truncate max-w-[12rem] sm:max-w-[14rem]">Loading...</div>
                    <div id="renterEmail" class="text-white/80 text-xs truncate max-w-[14rem] sm:max-w-[16rem]">Loading...</div>
                </div>
            </div>

            <button onclick="logout()"
                    class="px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 font-semibold">
                Logout
            </button>
        </div>
    </div>
</header>



<div class="max-w-6xl mx-auto px-6 py-8 md:py-10 space-y-8 md:space-y-10 animate-fade-in-up">

    <!-- Search -->
    <section class="bg-white rounded-2xl shadow-sm ring-1 ring-gray-200 p-5 space-y-4">
        <h2 class="text-xl font-semibold">üîç Search Rooms</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <input id="searchLocation" placeholder="Location" class="w-full border rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400" />
            <input id="searchMaxRent" type="number" placeholder="Max Rent" class="w-full border rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400" />
            <select id="searchType" class="w-full border rounded-xl px-4 py-2 focus:ring-2 focus:ring-indigo-400">
                <option value="">All Types</option>
                <option value="SINGLE">Single</option>
                <option value="SHARED">Shared</option>
                <option value="FAMILY">Family</option>
            </select>
            <button onclick="searchRooms()" class="w-full rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 font-medium shadow-sm">Apply</button>
        </div>
    </section>

    <!-- Request status toast placeholder -->
    <div id="requestStatus" class="text-center font-semibold text-base min-h-[1.25rem]"></div>

    <!-- All Rooms -->
    <section>
        <h2 class="text-xl font-semibold mb-3">üèòÔ∏è All Available Rooms</h2>
        <div id="allRooms" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- skeletons -->
            <div class="p-3 space-y-3">
                <div class="skeleton h-40 w-full"></div>
                <div class="skeleton h-4 w-3/4"></div>
                <div class="skeleton h-4 w-1/2"></div>
                <div class="skeleton h-9 w-full"></div>
            </div>
            <div class="p-3 space-y-3">
                <div class="skeleton h-40 w-full"></div>
                <div class="skeleton h-4 w-2/3"></div>
                <div class="skeleton h-4 w-1/3"></div>
                <div class="skeleton h-9 w-full"></div>
            </div>
        </div>
    </section>

    <!-- Pending -->
    <section>
        <h2 class="text-xl font-semibold mb-3">üïì Pending Room Requests</h2>
        <div id="pendingRequests" class="space-y-6"></div>

    </section>

    <!-- Confirmation (Awaiting Payment) -->
    <section id="confirmationSection" class="hidden">
        <div class="flex items-center justify-between mb-2">
            <h2 class="text-xl font-semibold text-gray-800">üßæ Confirmation (Awaiting Payment)</h2>
            <button id="confirmationRefresh" type="button" class="text-sm bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded-xl shadow-sm">
                Refresh
            </button>
        </div>
        <p id="confirmationNote" class="text-sm text-gray-600 mb-4 hidden">
            Your booking is approved. Please pay 25% within 3 days. If time runs out, the booking will auto-expire.
        </p>
        <div id="confirmationList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        <div id="confirmationStatus" class="mt-4 text-sm text-gray-600"></div>
    </section>

    <!-- Visit & Decide (after deposit confirmed) -->
    <section id="visitSection" class="hidden">
        <div class="flex items-center justify-between mb-2">
            <h2 class="text-xl font-semibold text-gray-800">üß≠ Visit & Decide</h2>
            <button id="visitRefresh" type="button" class="text-sm bg-gray-800 hover:bg-black text-white px-3 py-1.5 rounded-xl shadow-sm">
                Refresh
            </button>
        </div>
        <p class="text-sm text-gray-600 mb-4">
            Your deposit is confirmed. Visit within 3 days. If you like the room, pay the remaining 75% offline and confirm completion.
            If not, request a refund from admin.
        </p>
        <div id="visitList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </section>

    <!-- Recent Updates -->
    <section id="recentUpdatesSec" class="bg-white p-6 rounded-2xl shadow-sm ring-1 ring-gray-200 hidden">
        <div class="flex items-center justify-between">
            <h2 class="text-xl font-semibold">üì∞ Recent Updates</h2>
            <button id="updatesRefresh" type="button" class="text-sm bg-gray-800 hover:bg-black text-white px-3 py-1.5 rounded-xl shadow-sm">
                Refresh
            </button>
        </div>
        <ul id="recentUpdatesList" class="mt-3 space-y-3"></ul>
    </section>
</div>

<!-- Cancel Modal -->
<div id="cancelModal" class="fixed inset-0 z-40 hidden">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative mx-auto mt-28 w-[95%] max-w-md bg-white rounded-2xl shadow-xl p-6">
        <h2 class="text-xl font-semibold text-red-600 mb-4 text-center">Are you sure to cancel this booking?</h2>
        <div class="flex justify-center gap-4">
            <button id="cancelNoBtn" class="bg-gray-400 text-white px-5 py-2 rounded-xl hover:bg-gray-500">No</button>
            <button id="cancelYesBtn" class="bg-red-600 text-white px-5 py-2 rounded-xl hover:bg-red-700">Yes</button>
        </div>
    </div>
</div>

<!-- Decision Modal (Refund / Complete) -->
<div id="decisionModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="relative mx-auto mt-28 w-[95%] max-w-md bg-white rounded-2xl shadow-xl p-5">
        <h3 id="decisionTitle" class="text-lg font-semibold mb-2">Your decision</h3>
        <!-- Only for REFUND -->
        <div id="decisionNoteWrap" class="mb-3">
            <p id="decisionNoteLabel" class="text-sm text-gray-600 mb-3">
                Optional note for admin (why refund / any info):
            </p>
            <textarea id="decisionNoteInput" rows="4"
                      class="w-full border rounded-xl px-3 py-2
         bg-slate-50 text-slate-900 placeholder-slate-400
         focus:ring-2 focus:ring-emerald-400 focus:border-emerald-400"
                      placeholder="Type a short note (optional)"></textarea>

        </div>
        <div class="mt-4 flex justify-end gap-2">
            <button id="decisionCancelBtn" class="px-4 py-2 rounded-xl bg-gray-200 hover:bg-gray-300">Cancel</button>
            <button id="decisionSubmitBtn" class="px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700">Submit</button>
        </div>
    </div>
</div>

<!-- Toast -->
<div id="rdToast" class="fixed bottom-6 right-6 hidden px-4 py-2 text-white shadow-lg"></div>

<script src="js/renter-dashboard.js"></script>
</body>
</html>